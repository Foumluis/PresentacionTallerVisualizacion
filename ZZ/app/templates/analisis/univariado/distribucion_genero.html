{% extends 'base.html' %}

{% block title %}Distribución de Clientes por Género{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <h2><i class="bi bi-gender-ambiguous me-2"></i>Distribución de Clientes por Género</h2>
            <p class="text-muted">Análisis univariado de la distribución de clientes según su género</p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Gráfico de Distribución</h5>
                </div>
                <div class="card-body">
                    <canvas id="genderChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Estadísticas</h5>
                </div>
                <div class="card-body">
                    <p>Aquí puedes agregar las estadísticas relacionadas con la distribución de clientes por género.</p>
                    <!-- Add your statistics here -->
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Interpretación</h5>
                </div>
                <div class="card-body">
                    <p>Incluye aquí la interpretación de los datos y los insights obtenidos del análisis.</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}

{{ x|json_script:"x" }}
{{ y|json_script:"y" }}

<script>
    const x = JSON.parse(document.getElementById('x').textContent);
    const y = JSON.parse(document.getElementById('y').textContent);
    let delayed
  // obtener el contexto 2D del canvas
    const ctx = document.getElementById('genderChart').getContext('2d');

    const miGrafico = new Chart(ctx, {// grafico y el indice
        type: 'bar',// tipo de barra
        data: {
            labels: x,// nombre del eje x
            datasets: [{//datos a ocupar
            label: 'Ventas ($)',//nombre del eje y
            data: y,//datos
            backgroundColor: ["Cyan","Pink"],//color de las barras
            borderColor: 'rgba(54, 162, 235, 1)',//color de los bordes
            borderWidth: 1// tamaño del borde
            }]
        },
        options: {//opciones
            animation: {
                onComplete: () => {
                    delayed = true;
                },
                delay: (context) => {
                    let delay = 0;
                    if (context.type === 'data' && context.mode === 'default' && !delayed) {
                    delay = context.dataIndex * 300 + context.datasetIndex * 100;
                    }
                    return delay;
                },
            },
            responsive: true,// si al pasar por encima se coloca algun tipo de informacion
            plugins: {
            legend: { display: false }// no mostrar la leyenda
            },
            scales: {
            y: {
                beginAtZero: true,// indicamos que empiece de cero
                title: { display: true, text: 'Cantidad de clientes' }//titulo del eje y
            },
            x: {
                title: { display: true, text: 'Sexo' }//titulo del eje x
            }
            }
        }
        });
</script>
{% endblock %}
